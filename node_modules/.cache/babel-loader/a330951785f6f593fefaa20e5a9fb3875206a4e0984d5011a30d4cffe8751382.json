{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { api } from '../../services/api';\nconst initialState = {\n  candidates: [],\n  currentCandidate: null,\n  loading: false,\n  error: null,\n  filters: {\n    search: '',\n    stage: ''\n  },\n  pagination: {\n    page: 1,\n    pageSize: 50,\n    total: 0\n  }\n};\n\n// Async thunks\nexport const fetchCandidates = createAsyncThunk('candidates/fetchCandidates', async (params = {}) => {\n  const response = await api.getCandidates(params);\n  return response;\n});\nexport const updateCandidate = createAsyncThunk('candidates/updateCandidate', async ({\n  id,\n  updates\n}) => {\n  const response = await api.updateCandidate(id, updates);\n  return response;\n});\nexport const addCandidateNote = createAsyncThunk('candidates/addNote', async ({\n  candidateId,\n  note\n}) => {\n  var _await$api$getCandida;\n  const candidate = await api.updateCandidate(candidateId, {\n    notes: [...(((_await$api$getCandida = (await api.getCandidates({})).data.find(c => c.id === candidateId)) === null || _await$api$getCandida === void 0 ? void 0 : _await$api$getCandida.notes) || []), {\n      ...note,\n      id: `note-${Date.now()}`,\n      createdAt: new Date()\n    }]\n  });\n  return candidate;\n});\nexport const fetchCandidateTimeline = createAsyncThunk('candidates/fetchTimeline', async candidateId => {\n  const response = await api.getCandidateTimeline(candidateId);\n  return {\n    candidateId,\n    timeline: response\n  };\n});\nconst candidatesSlice = createSlice({\n  name: 'candidates',\n  initialState,\n  reducers: {\n    setFilters: (state, action) => {\n      state.filters = {\n        ...state.filters,\n        ...action.payload\n      };\n      state.pagination.page = 1;\n    },\n    setPagination: (state, action) => {\n      state.pagination = {\n        ...state.pagination,\n        ...action.payload\n      };\n    },\n    setCurrentCandidate: (state, action) => {\n      state.currentCandidate = action.payload;\n    },\n    clearError: state => {\n      state.error = null;\n    },\n    // Optimistic update for stage changes\n    optimisticStageChange: (state, action) => {\n      var _state$currentCandida;\n      const {\n        candidateId,\n        newStage\n      } = action.payload;\n      const candidate = state.candidates.find(c => c.id === candidateId);\n      if (candidate) {\n        candidate.stage = newStage;\n      }\n      if (((_state$currentCandida = state.currentCandidate) === null || _state$currentCandida === void 0 ? void 0 : _state$currentCandida.id) === candidateId) {\n        state.currentCandidate.stage = newStage;\n      }\n    },\n    // Rollback for failed stage change\n    rollbackStageChange: (state, action) => {\n      var _state$currentCandida2;\n      const {\n        candidateId,\n        oldStage\n      } = action.payload;\n      const candidate = state.candidates.find(c => c.id === candidateId);\n      if (candidate) {\n        candidate.stage = oldStage;\n      }\n      if (((_state$currentCandida2 = state.currentCandidate) === null || _state$currentCandida2 === void 0 ? void 0 : _state$currentCandida2.id) === candidateId) {\n        state.currentCandidate.stage = oldStage;\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Fetch candidates\n    .addCase(fetchCandidates.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchCandidates.fulfilled, (state, action) => {\n      state.loading = false;\n      state.candidates = action.payload.data;\n      state.pagination = {\n        ...state.pagination,\n        total: action.payload.total,\n        page: action.payload.page\n      };\n    }).addCase(fetchCandidates.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.error.message || 'Failed to fetch candidates';\n    })\n    // Update candidate\n    .addCase(updateCandidate.fulfilled, (state, action) => {\n      var _state$currentCandida3;\n      const index = state.candidates.findIndex(candidate => candidate.id === action.payload.id);\n      if (index !== -1) {\n        state.candidates[index] = action.payload;\n      }\n      if (((_state$currentCandida3 = state.currentCandidate) === null || _state$currentCandida3 === void 0 ? void 0 : _state$currentCandida3.id) === action.payload.id) {\n        state.currentCandidate = action.payload;\n      }\n    }).addCase(updateCandidate.rejected, (state, action) => {\n      state.error = action.error.message || 'Failed to update candidate';\n    })\n    // Add note\n    .addCase(addCandidateNote.fulfilled, (state, action) => {\n      var _state$currentCandida4;\n      if (((_state$currentCandida4 = state.currentCandidate) === null || _state$currentCandida4 === void 0 ? void 0 : _state$currentCandida4.id) === action.payload.id) {\n        state.currentCandidate = action.payload;\n      }\n    });\n  }\n});\nexport const {\n  setFilters,\n  setPagination,\n  setCurrentCandidate,\n  clearError,\n  optimisticStageChange,\n  rollbackStageChange\n} = candidatesSlice.actions;\nexport default candidatesSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","initialState","candidates","currentCandidate","loading","error","filters","search","stage","pagination","page","pageSize","total","fetchCandidates","params","response","getCandidates","updateCandidate","id","updates","addCandidateNote","candidateId","note","_await$api$getCandida","candidate","notes","data","find","c","Date","now","createdAt","fetchCandidateTimeline","getCandidateTimeline","timeline","candidatesSlice","name","reducers","setFilters","state","action","payload","setPagination","setCurrentCandidate","clearError","optimisticStageChange","_state$currentCandida","newStage","rollbackStageChange","_state$currentCandida2","oldStage","extraReducers","builder","addCase","pending","fulfilled","rejected","message","_state$currentCandida3","index","findIndex","_state$currentCandida4","actions","reducer"],"sources":["C:/Users/Dakshish/talentflow/src/store/slices/candidatesSlice.ts"],"sourcesContent":["import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\r\nimport { Candidate, Note } from '../../types';\r\nimport { api } from '../../services/api';\r\n\r\ninterface CandidatesState {\r\n  candidates: Candidate[];\r\n  currentCandidate: Candidate | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  filters: {\r\n    search: string;\r\n    stage: string;\r\n  };\r\n  pagination: {\r\n    page: number;\r\n    pageSize: number;\r\n    total: number;\r\n  };\r\n}\r\n\r\nconst initialState: CandidatesState = {\r\n  candidates: [],\r\n  currentCandidate: null,\r\n  loading: false,\r\n  error: null,\r\n  filters: {\r\n    search: '',\r\n    stage: '',\r\n  },\r\n  pagination: {\r\n    page: 1,\r\n    pageSize: 50,\r\n    total: 0,\r\n  },\r\n};\r\n\r\n// Async thunks\r\nexport const fetchCandidates = createAsyncThunk(\r\n  'candidates/fetchCandidates',\r\n  async (params: { page?: number; pageSize?: number; search?: string; stage?: string } = {}) => {\r\n    const response = await api.getCandidates(params);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const updateCandidate = createAsyncThunk(\r\n  'candidates/updateCandidate',\r\n  async ({ id, updates }: { id: string; updates: Partial<Candidate> }) => {\r\n    const response = await api.updateCandidate(id, updates);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const addCandidateNote = createAsyncThunk(\r\n  'candidates/addNote',\r\n  async ({ candidateId, note }: { candidateId: string; note: Omit<Note, 'id' | 'createdAt'> }) => {\r\n    const candidate = await api.updateCandidate(candidateId, {\r\n      notes: [...(await api.getCandidates({})).data.find((c: Candidate) => c.id === candidateId)?.notes || [], \r\n      {\r\n        ...note,\r\n        id: `note-${Date.now()}`,\r\n        createdAt: new Date(),\r\n      }]\r\n    });\r\n    return candidate;\r\n  }\r\n);\r\n\r\nexport const fetchCandidateTimeline = createAsyncThunk(\r\n  'candidates/fetchTimeline',\r\n  async (candidateId: string) => {\r\n    const response = await api.getCandidateTimeline(candidateId);\r\n    return { candidateId, timeline: response };\r\n  }\r\n);\r\n\r\nconst candidatesSlice = createSlice({\r\n  name: 'candidates',\r\n  initialState,\r\n  reducers: {\r\n    setFilters: (state, action: PayloadAction<Partial<CandidatesState['filters']>>) => {\r\n      state.filters = { ...state.filters, ...action.payload };\r\n      state.pagination.page = 1;\r\n    },\r\n    setPagination: (state, action: PayloadAction<Partial<CandidatesState['pagination']>>) => {\r\n      state.pagination = { ...state.pagination, ...action.payload };\r\n    },\r\n    setCurrentCandidate: (state, action: PayloadAction<Candidate | null>) => {\r\n      state.currentCandidate = action.payload;\r\n    },\r\n    clearError: (state) => {\r\n      state.error = null;\r\n    },\r\n    // Optimistic update for stage changes\r\n    optimisticStageChange: (state, action: PayloadAction<{ candidateId: string; newStage: Candidate['stage'] }>) => {\r\n      const { candidateId, newStage } = action.payload;\r\n      const candidate = state.candidates.find(c => c.id === candidateId);\r\n      if (candidate) {\r\n        candidate.stage = newStage;\r\n      }\r\n      if (state.currentCandidate?.id === candidateId) {\r\n        state.currentCandidate.stage = newStage;\r\n      }\r\n    },\r\n    // Rollback for failed stage change\r\n    rollbackStageChange: (state, action: PayloadAction<{ candidateId: string; oldStage: Candidate['stage'] }>) => {\r\n      const { candidateId, oldStage } = action.payload;\r\n      const candidate = state.candidates.find(c => c.id === candidateId);\r\n      if (candidate) {\r\n        candidate.stage = oldStage;\r\n      }\r\n      if (state.currentCandidate?.id === candidateId) {\r\n        state.currentCandidate.stage = oldStage;\r\n      }\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // Fetch candidates\r\n      .addCase(fetchCandidates.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchCandidates.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.candidates = action.payload.data;\r\n        state.pagination = {\r\n          ...state.pagination,\r\n          total: action.payload.total,\r\n          page: action.payload.page,\r\n        };\r\n      })\r\n      .addCase(fetchCandidates.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.error.message || 'Failed to fetch candidates';\r\n      })\r\n      // Update candidate\r\n      .addCase(updateCandidate.fulfilled, (state, action) => {\r\n        const index = state.candidates.findIndex(candidate => candidate.id === action.payload.id);\r\n        if (index !== -1) {\r\n          state.candidates[index] = action.payload;\r\n        }\r\n        if (state.currentCandidate?.id === action.payload.id) {\r\n          state.currentCandidate = action.payload;\r\n        }\r\n      })\r\n      .addCase(updateCandidate.rejected, (state, action) => {\r\n        state.error = action.error.message || 'Failed to update candidate';\r\n      })\r\n      // Add note\r\n      .addCase(addCandidateNote.fulfilled, (state, action) => {\r\n        if (state.currentCandidate?.id === action.payload.id) {\r\n          state.currentCandidate = action.payload;\r\n        }\r\n      });\r\n  },\r\n});\r\n\r\nexport const {\r\n  setFilters,\r\n  setPagination,\r\n  setCurrentCandidate,\r\n  clearError,\r\n  optimisticStageChange,\r\n  rollbackStageChange,\r\n} = candidatesSlice.actions;\r\n\r\nexport default candidatesSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}